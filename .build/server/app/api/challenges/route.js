"use strict";(()=>{var e={};e.id=21,e.ids=[21],e.modules={3524:e=>{e.exports=require("@prisma/client")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4315:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>f,patchFetch:()=>v,requestAsyncStorage:()=>g,routeModule:()=>d,serverHooks:()=>m,staticGenerationAsyncStorage:()=>h});var r={};a.r(r),a.d(r,{GET:()=>u,POST:()=>p,dynamic:()=>l});var n=a(9303),s=a(8716),o=a(3131),i=a(7070);let l="force-dynamic";async function c(){let{prisma:e}=await a.e(487).then(a.bind(a,9487));return e}async function u(e){try{if("phase-production-build"===process.env.NEXT_PHASE)return i.NextResponse.json({challenges:[],pagination:{page:1,limit:12,total:0,pages:0}});let t=await c(),{searchParams:a}=new URL(e.url),r=a.get("category"),n=a.get("difficulty"),s=a.get("status"),o=parseInt(a.get("page")||"1"),l=parseInt(a.get("limit")||"12"),u=(o-1)*l,p={isActive:!0};r&&(p.category=r),n&&(p.difficulty=n),s&&(p.status=s);let[d,g]=await Promise.all([t.challenge.findMany({where:p,include:{creator:{select:{id:!0,name:!0,avatar:!0}},_count:{select:{submissions:!0}}},orderBy:{createdAt:"desc"},skip:u,take:l}),t.challenge.count({where:p})]);return i.NextResponse.json({challenges:d,pagination:{page:o,limit:l,total:g,pages:Math.ceil(g/l)}})}catch(e){return console.error("Challenges fetch error:",e),i.NextResponse.json({error:"Failed to fetch challenges"},{status:500})}}async function p(e){try{if("phase-production-build"===process.env.NEXT_PHASE)return i.NextResponse.json({error:"Not available during build"},{status:503});let t=await c(),a=await e.json(),r=await t.challenge.create({data:{...a,creatorId:"placeholder-user-id"},include:{creator:{select:{id:!0,name:!0,avatar:!0}},_count:{select:{submissions:!0}}}});return i.NextResponse.json(r,{status:201})}catch(e){return console.error("Challenge creation error:",e),i.NextResponse.json({error:"Failed to create challenge"},{status:500})}}let d=new n.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/challenges/route",pathname:"/api/challenges",filename:"route",bundlePath:"app/api/challenges/route"},resolvedPagePath:"/home/ubuntu/fotoverse/app/app/api/challenges/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:g,staticGenerationAsyncStorage:h,serverHooks:m}=d,f="/api/challenges/route";function v(){return(0,o.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:h})}}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[276,972],()=>a(4315));module.exports=r})();