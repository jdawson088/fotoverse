"use strict";(()=>{var e={};e.id=657,e.ids=[657],e.modules={3524:e=>{e.exports=require("@prisma/client")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8020:(e,t,o)=>{o.r(t),o.d(t,{originalPathname:()=>v,patchFetch:()=>y,requestAsyncStorage:()=>m,routeModule:()=>d,serverHooks:()=>h,staticGenerationAsyncStorage:()=>g});var a={};o.r(a),o.d(a,{GET:()=>u,POST:()=>l,dynamic:()=>c});var r=o(9303),n=o(8716),i=o(3131),s=o(7070);let c="force-dynamic";async function p(){let{prisma:e}=await o.e(487).then(o.bind(o,9487));return e}async function u(e){try{if("phase-production-build"===process.env.NEXT_PHASE)return s.NextResponse.json({locations:[],pagination:{page:1,limit:12,total:0,pages:0}});let t=await p(),{searchParams:o}=new URL(e.url),a=o.get("search"),r=o.get("type"),n=o.get("vibe"),i=o.get("city"),c=o.get("minPrice"),u=o.get("maxPrice"),l=parseInt(o.get("page")||"1"),d=parseInt(o.get("limit")||"12"),m=(l-1)*d,g={isActive:!0};a&&(g.OR=[{title:{contains:a,mode:"insensitive"}},{description:{contains:a,mode:"insensitive"}},{city:{contains:a,mode:"insensitive"}}]),r&&(g.type=r),n&&(g.vibe=n),i&&(g.city={contains:i,mode:"insensitive"}),(c||u)&&(g.hourlyRate={},c&&(g.hourlyRate.gte=parseFloat(c)),u&&(g.hourlyRate.lte=parseFloat(u)));let[h,v]=await Promise.all([t.location.findMany({where:g,include:{owner:{select:{id:!0,name:!0,avatar:!0}}},orderBy:{createdAt:"desc"},skip:m,take:d}),t.location.count({where:g})]);return s.NextResponse.json({locations:h,pagination:{page:l,limit:d,total:v,pages:Math.ceil(v/d)}})}catch(e){return console.error("Locations fetch error:",e),s.NextResponse.json({error:"Failed to fetch locations"},{status:500})}}async function l(e){try{if("phase-production-build"===process.env.NEXT_PHASE)return s.NextResponse.json({error:"Not available during build"},{status:503});let t=await p(),o=await e.json(),a=await t.location.create({data:{...o,ownerId:"placeholder-user-id"},include:{owner:{select:{id:!0,name:!0,avatar:!0}}}});return s.NextResponse.json(a,{status:201})}catch(e){return console.error("Location creation error:",e),s.NextResponse.json({error:"Failed to create location"},{status:500})}}let d=new r.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/locations/route",pathname:"/api/locations",filename:"route",bundlePath:"app/api/locations/route"},resolvedPagePath:"/home/ubuntu/fotoverse/app/app/api/locations/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:m,staticGenerationAsyncStorage:g,serverHooks:h}=d,v="/api/locations/route";function y(){return(0,i.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:g})}}};var t=require("../../../webpack-runtime.js");t.C(e);var o=e=>t(t.s=e),a=t.X(0,[276,972],()=>o(8020));module.exports=a})();